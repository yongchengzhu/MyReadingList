<% include ./partials/header.ejs %>

<div class="ui container main">
    <!-- Forms For Sorting -->
    <form id="titleForm" action="/lists/sorted"" method="POST">
        <input type="hidden" name="sort" value="title">
    </form>
    <form id="lastReadForm" action="/lists/sorted"" method="POST">
        <input type="hidden" name="sort" value="lastRead">
    </form>
    <form id="genreForm" action="/lists/sorted"" method="POST">
        <input type="hidden" name="sort" value="genre">
    </form>
    <form id="ratingForm" action="/lists/sorted"" method="POST">
        <input type="hidden" name="sort" value="rating">
    </form>
    <form id="authorForm" action="/lists/sorted"" method="POST">
        <input type="hidden" name="sort" value="author">
    </form>
    <form id="createdForm" action="/lists/sorted"" method="POST">
        <input type="hidden" name="sort" value="created">
    </form>
    
    <!--Table-->
    <table class="ui selectable celled table">
        <thead><tr>
            <th id="titleLabel">Title</th>
            <th id="lastReadLabel">Last Read</th>
            <th id="genreLabel">Genre</th>
            <th id="ratingLabel">Rating</th>
            <th id="authorLabel">Author</th>
            <th id="createdLabel">Last Activity Timestamp</th>
        </tr></thead>
        <tbody>
        <% lists.forEach(function(list, i) { %>
            <tr>
                <td>
                    <a href="/lists/<%=list._id%>" class="popupTest" data-html="<img class='ui image rounded small' src='<%= list.image %>'>" data-position="left center">
                        <%= list.title %>
                    </a>
                </td>
                <td><%= list.lastRead %></td>
                <td><%= list.genre %></td>
                <td><div class="ui mini heart rating" data-rating=<%= list.rating %>></div></td>
                <td><%= list.author %></td>
                <td><%= list.created.toLocaleDateString() %> <%= list.created.toLocaleTimeString() %></td>
            </tr>
        <% }); %>
        </tbody>
    </table>
</div>

<script>
    $('.ui.rating').rating({ maxRating: 5 });
    $('.ui.rating').rating("disable");
    
    $('#titleLabel').on("click", function() {
        $("#titleForm").submit();
    });
    $('#lastReadLabel').on("click", function() {
        $("#lastReadForm").submit();
    });
    $('#genreLabel').on("click", function() {
        $("#genreForm").submit();
    });
    $('#ratingLabel').on("click", function() {
        $("#ratingForm").submit();
    });
    $('#authorLabel').on("click", function() {
        $("#authorForm").submit();
    });
    $('#createdLabel').on("click", function() {
        $("#createdForm").submit();
    });
    
    $(".popupTest").popup();
</script>

<% include ./partials/footer.ejs %>